<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../../img/favicon.ico">
        <title>vortex.development.core.factory - Vortex</title>
        <link href="../../css/bootstrap.min.css" rel="stylesheet">
        <link href="../../css/font-awesome.min.css" rel="stylesheet">
        <link href="../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/ir-black.min.css">

        <script src="../../js/jquery-1.10.2.min.js" defer></script>
        <script src="../../js/bootstrap.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/python.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/console.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/yaml.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="../..">Vortex</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbar-collapse">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="navitem">
                                <a href="../.." class="nav-link">Home</a>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">User Guides <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../user-guides/dataset_integration/" class="dropdown-item">Dataset Integration</a>
</li>
                                    
<li>
    <a href="../../user-guides/experiment_file_config/" class="dropdown-item">Experiment File Configuration</a>
</li>
                                    
<li>
    <a href="../../user-guides/hypopt_file_config/" class="dropdown-item">HypOpt File Configuration</a>
</li>
                                    
<li>
    <a href="../../user-guides/pipelines/" class="dropdown-item">Pipelines</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Developer Guides <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../developer-guides/custom_backbone_integration/" class="dropdown-item">Custom Backbone Integration</a>
</li>
                                    
<li>
    <a href="../../developer-guides/custom_model_integration_classification/" class="dropdown-item">Custom Model Integration : Classification</a>
</li>
                                    
<li>
    <a href="../../developer-guides/custom_model_integration_detection/" class="dropdown-item">Custom Model Integration : Detection</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Modules <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../modules/builtin_dataset/" class="dropdown-item">Built-in Dataset</a>
</li>
                                    
<li>
    <a href="../../modules/logging_provider/" class="dropdown-item">Logging Provider</a>
</li>
                                    
<li>
    <a href="../../modules/augmentation/" class="dropdown-item">Augmentations</a>
</li>
                                    
<li>
    <a href="../../modules/data_loader/" class="dropdown-item">Data Loader</a>
</li>
                                    
<li>
    <a href="../../modules/scheduler/" class="dropdown-item">Learning Rates Scheduler</a>
</li>
                                    
<li>
    <a href="../../modules/train_driver/" class="dropdown-item">Training Driver</a>
</li>
                                    
<li>
    <a href="../../modules/models_zoo/" class="dropdown-item">Models Zoo</a>
</li>
                                    
<li>
    <a href="../../modules/backbones/" class="dropdown-item">Backbones Network</a>
</li>
                                    
<li>
    <a href="../../modules/exporter/" class="dropdown-item">Graph Exporter</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown active">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">API <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../vortex.development.core.pipelines/" class="dropdown-item">vortex.development.core.pipelines</a>
</li>
                                    
<li>
    <a href="./" class="dropdown-item active">vortex.development.core.factory</a>
</li>
                                    
<li>
    <a href="../vortex.runtime/" class="dropdown-item">vortex.runtime</a>
</li>
                                </ul>
                            </li>
                            <li class="navitem">
                                <a href="https://github.com/nodefluxio/vortex" class="nav-link">Repository</a>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ml-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li class="nav-item">
                                <a rel="prev" href="../vortex.development.core.pipelines/" class="nav-link">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li class="nav-item">
                                <a rel="next" href="../vortex.runtime/" class="nav-link">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-light navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-toggle="collapse" data-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-secondary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-level="1"><a href="#vortexdevelopmentcorefactory" class="nav-link">vortex.development.core.factory</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="2"><a href="#functions" class="nav-link">Functions</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="3"><a href="#create_model" class="nav-link">create_model</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="3"><a href="#create_dataloader" class="nav-link">create_dataloader</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<h1 id="vortexdevelopmentcorefactory">vortex.development.core.factory<a class="headerlink" href="#vortexdevelopmentcorefactory" title="Permanent link">&para;</a></h1>
<hr />
<hr />
<h2 id="functions">Functions<a class="headerlink" href="#functions" title="Permanent link">&para;</a></h2>
<hr />
<hr />
<h3 id="create_model">create_model<a class="headerlink" href="#create_model" title="Permanent link">&para;</a></h3>
<p>Function to create model and it's signature components. E.g. loss function, collate function, etc</p>
<pre><code class="language-python">def create_model(
      model_config : easydict.EasyDict,
      state_dict : typing.Union[str, dict, pathlib.Path] = None,
      stage : str = 'train',
)
</code></pre>
<p><strong>Arguments</strong>:</p>
<ul>
<li><code>model_config</code> <em>EasyDict</em> - Experiment file configuration at <code>model</code> section, as EasyDict object</li>
<li><code>state_dict</code> <em>Union[str, dict, Path], optional</em> - [description]. <code>model</code> Pytorch state dictionary or commonly known as weight, can be provided as the path to the file, or the returned dictionary object from <code>torch.load</code>. If this param is provided, it will override checkpoint specified in the experiment file. Defaults to None.</li>
<li><code>stage</code> <em>str, optional</em> - If set to 'train', this will enforce that the model must have <code>loss</code> and <code>collate_fn</code> attributes, hence it will make sure model can be used for training stage. If set to 'validate' it will ignore those requirements but cannot be used in training pipeline, but may still valid for other pipelines. Defaults to 'train'.</li>
</ul>
<p><strong>Returns</strong>:</p>
<ul>
<li><code>EasyDict</code> - The dictionary containing the model's components</li>
</ul>
<p><strong>Raises</strong>:</p>
<ul>
<li><code>TypeError</code> - Raises if the provided <code>stage</code> not in 'train' or 'validate'</li>
</ul>
<p><strong>Examples</strong>:</p>
<p>The dictionary returned will contain several keys :</p>
<ul>
<li><code>network</code> : Pytorch model's object which inherit <code>torch.nn.Module</code> class.</li>
<li><code>preprocess</code> : model's preprocessing module</li>
<li><code>postprocess</code> : model's postprocessing module</li>
<li><code>loss</code> : if provided, module for model's loss function</li>
<li><code>collate_fn</code> : if provided, module to be embedded to dataloader's <code>collate_fn</code> function to modify dataset label's format into desirable format that can be accepted by <code>loss</code> components</li>
</ul>
<pre><code class="language-python">from vortex.development.core.factory import create_model
from easydict import EasyDict

model_config = EasyDict({
    'name': 'softmax',
    'network_args': {
        'backbone': 'efficientnet_b0',
        'n_classes': 10,
        'pretrained_backbone': True,
    },
    'preprocess_args': {
        'input_size': 32,
        'input_normalization': {
        'mean': [0.4914, 0.4822, 0.4465],
        'std': [0.2023, 0.1994, 0.2010],
        'scaler': 255,
        }
    },
    'loss_args': {
        'reduction': 'mean'
    }
})

model_components = create_model(
    model_config = model_config
)
print(model_components.keys())
</code></pre>
<hr />
<hr />
<h3 id="create_dataloader">create_dataloader<a class="headerlink" href="#create_dataloader" title="Permanent link">&para;</a></h3>
<p>Function to create iterable data loader object</p>
<pre><code class="language-python">def create_dataloader(
      dataloader_config : easydict.EasyDict,
      dataset_config : easydict.EasyDict,
      preprocess_config : easydict.EasyDict,
      stage : str = 'train',
      collate_fn : typing.Union[typing.Callable, str, NoneType] = None,
)
</code></pre>
<p><strong>Arguments</strong>:</p>
<ul>
<li><code>dataloader_config</code> <em>EasyDict</em> - Experiment file configuration at <code>dataloader</code> section, as EasyDict object</li>
<li><code>dataset_config</code> <em>EasyDict</em> - Experiment file configuration at <code>dataset</code> section, as EasyDict object</li>
<li><code>preprocess_config</code> <em>EasyDict</em> - Experiment file configuration at <code>model.preprocess_args</code> section, as EasyDict object</li>
<li><code>stage</code> <em>str, optional</em> - Specify the experiment stage, either 'train' or 'validate'. Defaults to 'train'.</li>
<li><code>collate_fn</code> <em>Union[Callable,str,None], optional</em> - Collate function to reformat batch data serving. Defaults to None.</li>
</ul>
<p><strong>Returns</strong>:</p>
<ul>
<li><code>Type[Iterable]</code> - Iterable dataloader object which served batch of data in every iteration</li>
</ul>
<p><strong>Raises</strong>:</p>
<ul>
<li><code>TypeError</code> - Raises if provided <code>collate_fn</code> type is neither 'str' (registered in Vortex), Callable (custom function), or None</li>
<li><code>RuntimeError</code> - Raises if specified 'dataloader' module is not registered</li>
</ul>
<p><strong>Examples</strong>:</p>
<pre><code class="language-python">from vortex.development.core.factory import create_dataloader
from easydict import EasyDict

dataloader_config = EasyDict({
    'module': 'PytorchDataLoader',
    'args': {
    'num_workers': 1,
    'batch_size': 4,
    'shuffle': True,
    },
})

dataset_config = EasyDict({
    'train': {
        'dataset': 'ImageFolder',
        'args': {
            'root': 'tests/test_dataset/classification/train'
        },
        'augmentations': [{
            'module': 'albumentations',
            'args': {
                'transforms': [
                {
                    'transform' : 'RandomBrightnessContrast', 
                    'args' : {
                        'p' : 0.5, 'brightness_by_max': False,
                        'brightness_limit': 0.1, 'contrast_limit': 0.1,
                    }
                },
                {'transform': 'HueSaturationValue', 'args': {}},
                {'transform' : 'HorizontalFlip', 'args' : {'p' : 0.5}},
                ]
            }
        }]
    },
})

preprocess_config = EasyDict({
    'input_size' : 224,
    'input_normalization' : {
        'mean' : [0.5,0.5,0.5],
        'std' : [0.5, 0.5, 0.5],
        'scaler' : 255
    },
})

dataloader = create_dataloader(dataloader_config=dataloader_config,
                                dataset_config=dataset_config,
                                preprocess_config = preprocess_config,
                                collate_fn=None)
for data in dataloader:
    images,labels = data
</code></pre>
<hr /></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>
            var base_url = "../..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../../js/base.js" defer></script>
        <script src="../../search/main.js" defer></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
